<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides a convenient way to analyze and visualize PICRUSt2 output with pre-defined plots and functions. Allows for generating statistical plots about microbiome functional predictions and offers customization options. Features a one-click option for creating publication-level plots, saving time and effort in producing professional-grade figures. Streamlines the PICRUSt2 analysis and visualization process. For more details, see Yang et al. (2023) &lt;arXiv:2303.10388&gt;.">
<title>Make PICRUSt2 Output Analysis and Visualization Easier • ggpicrust2</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Make PICRUSt2 Output Analysis and Visualization Easier">
<meta property="og:description" content="Provides a convenient way to analyze and visualize PICRUSt2 output with pre-defined plots and functions. Allows for generating statistical plots about microbiome functional predictions and offers customization options. Features a one-click option for creating publication-level plots, saving time and effort in producing professional-grade figures. Streamlines the PICRUSt2 analysis and visualization process. For more details, see Yang et al. (2023) &lt;arXiv:2303.10388&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ggpicrust2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cafferychen777/ggpicrust2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><p><img src="https://raw.iqiq.io/cafferychen777/ggpicrust2_paper/main/Contest_post.jpeg"></p>
<div class="section level1">
<div class="page-header"><h1 id="ggpicrust2-documentation">ggpicrust2 Documentation<a class="anchor" aria-label="anchor" href="#ggpicrust2-documentation"></a>
</h1></div>
<p><em>ggpicrust2</em> is a comprehensive package that integrates pathway name/description annotations, ten of the most advanced differential abundance (DA) methods, and visualization of DA results. It offers a comprehensive solution for analyzing and interpreting the results of PICRUSt2 functional prediction in a seamless and intuitive way. Whether you are a researcher, data scientist, or bioinformatician, <em>ggpicrust2</em> can help you better understand the underlying biological processes and mechanisms at play in your PICRUSt2 output data. So if you are interested in exploring the output data of PICRUSt2, <em>ggpicrust2</em> is the tool you need.</p>
<p><a href="https://CRAN.R-project.org/package=ggpicrust2" class="external-link"><img src="https://www.r-pkg.org/badges/version/ggpicrust2" alt="CRAN version"></a> <a href="https://CRAN.R-project.org/package=ggpicrust2" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/ggpicrust2" alt="Downloads"></a> <a href="https://opensource.org/license/mit/" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a></p>
<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ul>
<li><a href="#citation">Citation</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#stay-updated">Stay Updated</a></li>
<li><a href="#workflow">Workflow</a></li>
<li><a href="#output">Output</a></li>
<li>
<a href="#function-details">Function Details</a>
<ul>
<li><a href="#ko2kegg_abundance">ko2kegg_abundance()</a></li>
<li><a href="#pathway_daa">pathway_daa()</a></li>
<li><a href="#pathway_annotation">pathway_annotation()</a></li>
<li><a href="#pathway_errorbar">pathway_errorbar()</a></li>
<li><a href="#pathway_heatmap">pathway_heatmap()</a></li>
<li><a href="#pathway_pca">pathway_pca()</a></li>
</ul>
</li>
<li><a href="#faq">FAQ</a></li>
<li><a href="#authors-other-projects">Author’s Other Projects</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <em>ggpicrust2</em> in your research, please cite the following paper:</p>
<p>Chen Yang, Aaron Burberry, Xuan Cao, Jiahao Mai, Liangliang Zhang. (2023). <a href="https://arxiv.org/abs/2303.10388" class="external-link">ggpicrust2: an R package for PICRUSt2 predicted functional profile analysis and visualization.</a> arXiv preprint arXiv:2303.10388.</p>
<p>BibTeX entry: @misc{yang2023ggpicrust2, title={ggpicrust2: an R package for PICRUSt2 predicted functional profile analysis and visualization}, author={Chen Yang and Aaron Burberry and Jiahao Mai and Xuan Cao and Liangliang Zhang}, year={2023}, eprint={2303.10388}, archivePrefix={arXiv}, primaryClass={stat.AP} }</p>
<p>ResearchGate preprint link: <a href="https://www.researchgate.net/publication/369380349_ggpicrust2_an_R_package_for_PICRUSt2_predicted_functional_profile_analysis_and_visualization" class="external-link">Click here</a></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the stable version of <em>ggpicrust2</em> from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggpicrust2"</span><span class="op">)</span></span></code></pre></div>
<p>To install the latest development version of <em>ggpicrust2</em> from GitHub, you can use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the devtools package if not already installed</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span></span>
<span><span class="co"># Install ggpicrust2 from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"cafferychen777/ggpicrust2"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="stay-updated">Stay Updated<a class="anchor" aria-label="anchor" href="#stay-updated"></a>
</h2>
<p>Follow me on Twitter for the latest <em>ggpicrust2</em> updates: <a href="https://twitter.com/CafferyYang" class="external-link"><img src="https://img.shields.io/twitter/follow/CafferyYang?style=social"></a></p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The easiest way to analyze the PICRUSt2 output is using ggpicrust2() function. The entire pipeline can be run with ggpicrust2() function.</p>
<p>ggpicrust2() integrates ko abundance to kegg pathway abundance conversion, annotation of pathway, differential abundance (DA) analysis, DA results visualization. When you have trouble running ggpicrust2(), you can debug it by running a separate function, which will greatly increase the speed of your analysis and visualization</p>
<p><img src="https://github.moeyy.xyz/https://raw.githubusercontent.com/cafferychen777/ggpicrust2_paper/main/paper_figure/workflow_1.png"></p>
<p><img src="https://github.moeyy.xyz/https://raw.githubusercontent.com/cafferychen777/ggpicrust2_paper/main/paper_figure/workflow_2.png"></p>
<div class="section level3">
<h3 id="ggpicrust2">ggpicrust2()<a class="anchor" aria-label="anchor" href="#ggpicrust2"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#If you want to analysis kegg pathway abundance instead of ko within the pathway. You should turn ko_to_kegg to TRUE.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#The kegg pathway typically have the more explainable description.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpicrust2)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggprism)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_delim</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">escape_double =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="st">"Enviroment"</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>daa_results_list <span class="ot">&lt;-</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpicrust2</span>(</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">"/Users/apple/Microbiome/C9orf72/Code And Data/picrust2_out/KO_metagenome_out/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv"</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">metadata =</span> metadata,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"Enviroment"</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">pathway =</span> <span class="st">"KO"</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">daa_method =</span> <span class="st">"LinDA"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_values_bar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.adjust =</span> <span class="st">"BH"</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">ko_to_kegg =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="st">"pathway_class"</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="cn">NULL</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference =</span> <span class="cn">NULL</span> <span class="co"># If your metadata[,group] has more than two levels, please specify a reference.</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co">#If you want to analysis the EC. MetaCyc. KO without conversions. You should turn ko_to_kegg to FALSE.</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpicrust2)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggprism)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_delim</span>(</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">escape_double =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="st">"Enviroment"</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>daa_results_list <span class="ot">&lt;-</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpicrust2</span>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">"//Users/apple/Microbiome/C9orf72/Code And Data/picrust2_out/EC_metagenome_out/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv"</span>,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">metadata =</span> metadata,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"Enviroment"</span>,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">pathway =</span> <span class="st">"EC"</span>,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">daa_method =</span> <span class="st">"LinDA"</span>,</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_values_bar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="st">"group"</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">ko_to_kegg =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_lab =</span> <span class="st">"description"</span>,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.adjust =</span> <span class="st">"BH"</span>,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="cn">NULL</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference =</span> <span class="cn">NULL</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="if-an-error-occurs-with-ggpicrust2-please-use-the-following-workflow">If an error occurs with ggpicrust2, please use the following workflow.<a class="anchor" aria-label="anchor" href="#if-an-error-occurs-with-ggpicrust2-please-use-the-following-workflow"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#If you want to analysis kegg pathway abundance instead of ko within the pathway. You should turn ko_to_kegg to TRUE.</span></span>
<span><span class="co">#The kegg pathway typically have the more explainable description.</span></span>
<span><span class="co">#metadata should be tibble.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cafferychen777/ggpicrust2" class="external-link">ggpicrust2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://csdaw.github.io/ggprism/" class="external-link">ggprism</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span></span>
<span>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">kegg_abundance</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/ko2kegg_abundance.html">ko2kegg_abundance</a></span><span class="op">(</span></span>
<span>    <span class="st">"/Users/apple/Downloads/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"Enviroment"</span></span>
<span></span>
<span><span class="va">daa_results_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/pathway_daa.html">pathway_daa</a></span><span class="op">(</span></span>
<span>    abundance <span class="op">=</span> <span class="va">kegg_abundance</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>    group <span class="op">=</span> <span class="va">group</span>,</span>
<span>    daa_method <span class="op">=</span> <span class="st">"ALDEx2"</span>,</span>
<span>    select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    reference <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#if you are using LinDA, limme voom and Maaslin2, please specify a reference just like followings code.</span></span>
<span><span class="co"># daa_results_df &lt;- pathway_daa(abundance = kegg_abundance, metadata = metadata, group = group, daa_method = "LinDA", select = NULL, reference = "Harvard BRI")</span></span>
<span></span>
<span><span class="va">daa_sub_method_results_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">daa_results_df</span><span class="op">[</span><span class="va">daa_results_df</span><span class="op">$</span><span class="va">method</span> <span class="op">==</span> <span class="st">"ALDEx2_Kruskal-Wallace test"</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">daa_annotated_sub_method_results_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/pathway_annotation.html">pathway_annotation</a></span><span class="op">(</span>pathway <span class="op">=</span> <span class="st">"KO"</span>,</span>
<span>                     daa_results_df <span class="op">=</span> <span class="va">daa_sub_method_results_df</span>,</span>
<span>                     ko_to_kegg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Group</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">metadata</span><span class="op">$</span><span class="va">Enviroment</span> <span class="co"># column which you are interested in metadata</span></span>
<span></span>
<span><span class="co"># select parameter format in pathway_error() is c("ko00562", "ko00440", "ko04111", "ko05412", "ko00310", "ko04146", "ko00600", "ko04142", "ko00604", "ko04260", "ko04110", "ko04976", "ko05222", "ko05416", "ko00380", "ko05322", "ko00625", "ko00624", "ko00626", "ko00621")</span></span>
<span></span>
<span><span class="va">daa_results_list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/pathway_errorbar.html">pathway_errorbar</a></span><span class="op">(</span></span>
<span>    abundance <span class="op">=</span> <span class="va">kegg_abundance</span>,</span>
<span>    daa_results_df <span class="op">=</span> <span class="va">daa_annotated_sub_method_results_df</span>,</span>
<span>    Group <span class="op">=</span> <span class="va">Group</span>,</span>
<span>    p_values_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    order <span class="op">=</span> <span class="st">"pathway_class"</span>,</span>
<span>    select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    ko_to_kegg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    p_value_bar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x_lab <span class="op">=</span> <span class="st">"pathway_name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># x_lab can be set "feature" which represents kegg pathway id.</span></span>
<span></span>
<span><span class="co"># If you want to analysis the EC. MetaCyc. KO without conversions. You should turn ko_to_kegg to FALSE.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cafferychen777/ggpicrust2" class="external-link">ggpicrust2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://csdaw.github.io/ggprism/" class="external-link">ggprism</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span></span>
<span>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#ko_abundance should be data.frame instead of tibble</span></span>
<span><span class="co">#ID should be in the first column</span></span>
<span><span class="va">ko_abundance</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span></span>
<span>    <span class="st">"/Users/apple/Downloads/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#sometimes there are function, pathway or something else. Change function. when needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ko_abundance</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ko_abundance</span><span class="op">$</span><span class="va">function.</span></span>
<span><span class="va">ko_abundance</span> <span class="op">&lt;-</span> <span class="va">ko_abundance</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"Enviroment"</span></span>
<span></span>
<span><span class="va">daa_results_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/pathway_daa.html">pathway_daa</a></span><span class="op">(</span></span>
<span>    abundance <span class="op">=</span> <span class="va">ko_abundance</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>    group <span class="op">=</span> <span class="va">group</span>,</span>
<span>    daa_method <span class="op">=</span> <span class="st">"ALDEx2"</span>,</span>
<span>    select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    reference <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#if you are using LinDA, limme voom and Maaslin2, please specify a reference just like followings code.</span></span>
<span><span class="co"># daa_results_df &lt;- pathway_daa(abundance = kegg_abundance, metadata = metadata, group = group, daa_method = "LinDA", select = NULL, reference = "Harvard BRI")</span></span>
<span></span>
<span><span class="va">daa_sub_method_results_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">daa_results_df</span><span class="op">[</span><span class="va">daa_results_df</span><span class="op">$</span><span class="va">method</span> <span class="op">==</span> <span class="st">"ALDEx2_Kruskal-Wallace test"</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">daa_annotated_sub_method_results_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/pathway_annotation.html">pathway_annotation</a></span><span class="op">(</span>pathway <span class="op">=</span> <span class="st">"KO"</span>,</span>
<span>                     daa_results_df <span class="op">=</span> <span class="va">daa_sub_method_results_df</span>,</span>
<span>                     ko_to_kegg <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Group</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">metadata</span><span class="op">$</span><span class="va">Enviroment</span> <span class="co"># column which you are interested in metadata</span></span>
<span></span>
<span><span class="co"># select parameter format in pathway_error() is c("K00001", "K00002", "K00003", "K00004")</span></span>
<span></span>
<span><span class="va">daa_results_list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/pathway_errorbar.html">pathway_errorbar</a></span><span class="op">(</span></span>
<span>    abundance <span class="op">=</span> <span class="va">ko_abundance</span>,</span>
<span>    daa_results_df <span class="op">=</span> <span class="va">daa_annotated_sub_method_results_df</span>,</span>
<span>    Group <span class="op">=</span> <span class="va">Group</span>,</span>
<span>    p_values_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    order <span class="op">=</span> <span class="st">"pathway_class"</span>,</span>
<span>    select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    ko_to_kegg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    p_value_bar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x_lab <span class="op">=</span> <span class="st">"description"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>The typical output of the ggpicrust2 is like this.</p>
<p><img src="https://cdn.jsdelivr.ren/gh/cafferychen777/ggpicrust2_paper@main/paper_figure/figure1.jpg"></p>
</div>
<div class="section level2">
<h2 id="function-details">function details<a class="anchor" aria-label="anchor" href="#function-details"></a>
</h2>
<div class="section level3">
<h3 id="ko2kegg_abundance">ko2kegg_abundance()<a class="anchor" aria-label="anchor" href="#ko2kegg_abundance"></a>
</h3>
<p>KEGG Orthology(KO) is a classification system developed by the Kyoto Encyclopedia of Genes and Genomes (KEGG) data-base(Kanehisa et al., 2022). It uses a hierarchical structure to classify enzymes based on the reactions they catalyze. To better understand pathways’ role in different groups and classify the pathways, the KO abundance table needs to be converted to KEGG pathway abundance. But PICRUSt2 removes the function from PICRUSt. ko2kegg_abundance() can help convert the table.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample usage of the ko2kegg_abundance function</span></span>
<span></span>
<span><span class="co"># Assume that the KO abundance table is stored in a file named "ko_abundance.tsv"</span></span>
<span></span>
<span><span class="va">ko_abundance_file</span> <span class="op">&lt;-</span> <span class="st">"ko_abundance.tsv"</span></span>
<span></span>
<span><span class="va">kegg_abundance</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ko2kegg_abundance.html">ko2kegg_abundance</a></span><span class="op">(</span><span class="va">ko_abundance_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The resulting kegg_abundance data frame can now be used for further analysis and visualization.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_daa">pathway_daa()<a class="anchor" aria-label="anchor" href="#pathway_daa"></a>
</h3>
<p>Differential abundance(DA) analysis plays a major role in PICRUSt2 downstream analysis. pathway_daa() integrates almost all DA methods applicable to the predicted functional profile which there excludes ANCOM and ANCOMBC. It includes <a href="https://bioconductor.riken.jp/packages/3.9/bioc/html/ALDEx2.html" class="external-link">ALDEx2</a>(Fernandes et al., 2013), <a href="https://bioconductor.org/packages/release/bioc/html/DESeq2.html" class="external-link">DEseq2</a>(Love et al., 2014), <a href="https://www.bioconductor.org/packages/release/bioc/html/Maaslin2.html" class="external-link">Maaslin2</a>(Mallick et al., 2021), <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-022-02655-5" class="external-link">LinDA</a>(Zhou et al., 2022), <a href="https://bioconductor.org/packages/release/bioc/html/edgeR.html" class="external-link">edgeR</a>(Robinson et al., 2010) , <a href="https://ucdavis-bioinformatics-training.github.io/2018-June-RNA-Seq-Workshop/thursday/DE.html" class="external-link">limma voom</a>(Ritchie et al., 2015), <a href="https://www.bioconductor.org/packages/release/bioc/html/metagenomeSeq.html#:~:text=metagenomeSeq%20is%20designed%20to%20address,the%20testing%20of%20feature%20correlations." class="external-link">metagenomeSeq</a>(Paulson et al., 2013), <a href="http://bioconductor.org/packages/release/bioc/html/lefser.html" class="external-link">lefser</a>(Segata et al., 2011).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#the abundance table is better to be data.frame rather than tibble</span></span>
<span><span class="co">#you can use ko2_kegg_abundance output</span></span>
<span><span class="va">abundance</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ko2kegg_abundance.html">ko2kegg_abundance</a></span><span class="op">(</span><span class="va">ko_abundance_file</span><span class="op">)</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span></span>
<span>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"Enviroment"</span></span>
<span><span class="co">#daa_method default is "ALDex2"</span></span>
<span><span class="va">daa_results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pathway_daa.html">pathway_daa</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="va">abundance</span>,</span>
<span>           metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>           group <span class="op">=</span> <span class="va">group</span> ,</span>
<span>           daa_method <span class="op">=</span> <span class="st">"limma voom"</span>,</span>
<span>           select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           p.adjust <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>           reference <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#If you group levels &gt;3 and want to use the LinDA, limme voom and Maaslin2, you should give a reference.</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span></span>
<span>    <span class="st">"~/Microbiome/C9orf72/Code And Data/new_metadata.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"Group"</span></span>
<span><span class="va">daa_results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pathway_daa.html">pathway_daa</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="va">abundance</span>,</span>
<span>           metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>           group <span class="op">=</span> <span class="va">group</span> ,</span>
<span>           daa_method <span class="op">=</span> <span class="st">"limma voom"</span>,</span>
<span>           select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           p.adjust <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>           reference <span class="op">=</span> <span class="st">"Harvard BRI"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_annotation">pathway_annotation()<a class="anchor" aria-label="anchor" href="#pathway_annotation"></a>
</h3>
<p><strong>If you are in China and you are using kegg pathway annotation, Please make sure your internet can break through the firewall.</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">daa_results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pathway_annotation.html">pathway_annotation</a></span><span class="op">(</span>pathway <span class="op">=</span> <span class="st">"KO"</span>, daa_results_df <span class="op">=</span> <span class="va">daa_results_df</span>, ko_to_kegg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_errorbar">pathway_errorbar()<a class="anchor" aria-label="anchor" href="#pathway_errorbar"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pathway_errorbar.html">pathway_errorbar</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="va">abundance</span>,</span>
<span>           daa_results_df <span class="op">=</span> <span class="va">daa_results_df</span>,</span>
<span>           Group <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">Enviroment</span>,</span>
<span>           ko_to_kegg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           p_values_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>           order <span class="op">=</span> <span class="st">"pathway_class"</span>,</span>
<span>           select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           p_value_bar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           x_lab <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_heatmap">pathway_heatmap()<a class="anchor" aria-label="anchor" href="#pathway_heatmap"></a>
</h3>
<p>In this section, we will demonstrate how to create a pathway heatmap using the <code>pathway_heatmap</code> function in the ggpicrust2 package. This function visualizes the relative abundance of pathways in different samples.</p>
<p>First, we will create some example functional pathway abundance data and metadata:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example functional pathway abundance data</span></span>
<span><span class="va">abundance_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PathwayA"</span>, <span class="st">"PathwayB"</span>, <span class="st">"PathwayC"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create example metadata</span></span>
<span><span class="co"># Please change your sample id's column name to sample_name</span></span>
<span><span class="va">metadata_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span>,</span>
<span>                               group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we will use the pathway_heatmap function to create a heatmap:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a heatmap</span></span>
<span><span class="va">heatmap_plot</span> <span class="op">&lt;-</span> <span class="fu">ggpicrust2</span><span class="fu">::</span><span class="fu"><a href="reference/pathway_heatmap.html">pathway_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span>, <span class="va">metadata_example</span>, <span class="st">"group"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we will display the resulting heatmap:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">heatmap_plot</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pathway_pca">pathway_pca()<a class="anchor" aria-label="anchor" href="#pathway_pca"></a>
</h3>
<p>In this section, we will demonstrate how to perform Principal Component Analysis (PCA) on functional pathway abundance data and create visualizations of the PCA results using the <code>pathway_pca</code> function in the ggpicrust2 package.</p>
<p>First, we will create some example functional pathway abundance data and metadata:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example functional pathway abundance data</span></span>
<span><span class="va">abundance_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create example metadata</span></span>
<span><span class="va">metadata_example</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>sample_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>                                   group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we will use the pathway_pca function to perform PCA and create visualizations:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform PCA and create visualizations</span></span>
<span><span class="va">pca_plot</span> <span class="op">&lt;-</span> <span class="fu">ggpicrust2</span><span class="fu">::</span><span class="fu"><a href="reference/pathway_pca.html">pathway_pca</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">abundance_example</span><span class="op">)</span>, <span class="va">metadata_example</span>, <span class="st">"group"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we will display the resulting PCA plot:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pca_plot</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="share">Share<a class="anchor" aria-label="anchor" href="#share"></a>
</h2>
<p><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fgithub.com%2Fcafferychen777%2Fggpicrust2&amp;text=Check%20out%20this%20awesome%20package%20on%20GitHub%21" class="external-link"><img src="https://img.shields.io/twitter/url?url=https%253A%252F%252Fgithub.com%252Fcafferychen777%252Fggpicrust2&amp;style=social" alt="Twitter"></a></p>
<p><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fgithub.com%2Fcafferychen777%2Fggpicrust2&amp;quote=Check%20out%20this%20awesome%20package%20on%20GitHub%21" class="external-link"><img src="https://img.shields.io/badge/Share_on-Facebook-1877F2?logo=facebook&amp;style=social" alt="Facebook"></a></p>
<p><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fgithub.com%2Fcafferychen777%2Fggpicrust2&amp;title=Check%20out%20this%20awesome%20package%20on%20GitHub%21" class="external-link"><img src="https://img.shields.io/badge/Share_on-LinkedIn-0077B5?logo=linkedin&amp;style=social" alt="LinkedIn"></a></p>
<p><a href="https://www.reddit.com/submit?url=https%3A%2F%2Fgithub.com%2Fcafferychen777%2Fggpicrust2&amp;title=Check%20out%20this%20awesome%20package%20on%20GitHub%21" class="external-link"><img src="https://img.shields.io/badge/Share_on-Reddit-FF4500?logo=reddit&amp;style=social" alt="Reddit"></a></p>
</div>
<div class="section level2">
<h2 id="faq">FAQ<a class="anchor" aria-label="anchor" href="#faq"></a>
</h2>
<div class="section level3">
<h3 id="issue-1-pathway_errorbar-error">Issue 1: pathway_errorbar error<a class="anchor" aria-label="anchor" href="#issue-1-pathway_errorbar-error"></a>
</h3>
<p>When using <code>pathway_errorbar</code> with the following parameters:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pathway_errorbar.html">pathway_errorbar</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="va">abundance</span>,</span>
<span>                 daa_results_df <span class="op">=</span> <span class="va">daa_results_df</span>,</span>
<span>                 Group <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">Enviroment</span>,</span>
<span>                 ko_to_kegg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 p_values_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 order <span class="op">=</span> <span class="st">"pathway_class"</span>,</span>
<span>                 select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 p_value_bar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 x_lab <span class="op">=</span> <span class="st">"pathway_name"</span><span class="op">)</span></span></code></pre></div>
<p>You may encounter an error:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="st">`</span><span class="at">ggplot_add()</span><span class="st">`</span><span class="sc">:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> Can<span class="st">'t add `e2` to a &lt;ggplot&gt; object.</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="st">Run `rlang::last_trace()` to see where the error occurred.</span></span></code></pre></div>
<p>Make sure you have the <code>patchwork</code> package loaded:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="issue-2-guide_trainprism_offset_minor-error">Issue 2: guide_train.prism_offset_minor error<a class="anchor" aria-label="anchor" href="#issue-2-guide_trainprism_offset_minor-error"></a>
</h3>
<p>You may encounter an error with <code>guide_train.prism_offset_minor</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">guide_train.prism_offset_minor</span>(guide, panel_params[[aesthetic]]) <span class="sc">:</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  No minor breaks exist, guide_prism_offset_minor needs minor breaks to work</span></code></pre></div>
<p>Ensure that the <code>ggprism</code> package is loaded:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://csdaw.github.io/ggprism/" class="external-link">ggprism</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="issue-3-ssl-certificate-problem">Issue 3: SSL certificate problem<a class="anchor" aria-label="anchor" href="#issue-3-ssl-certificate-problem"></a>
</h3>
<p>When encountering the following error:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>SSL peer certificate or SSH remote key was not OK<span class="sc">:</span> [rest.kegg.jp] SSL certificate problem<span class="sc">:</span> certificate has expired</span></code></pre></div>
<p>If you are in China, make sure your computer network can bypass the firewall.</p>
</div>
<div class="section level3">
<h3 id="issue-4-bad-request-http-400">Issue 4: Bad Request (HTTP 400)<a class="anchor" aria-label="anchor" href="#issue-4-bad-request-http-400"></a>
</h3>
<p>When encountering the following error:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">.getUrl</span>(url, .flatFileParser) <span class="sc">:</span> Bad <span class="fu">Request</span> (HTTP <span class="dv">400</span>).</span></code></pre></div>
<p>Please restart R session.</p>
</div>
<div class="section level3">
<h3 id="issue-5-error-in-gridcallc_textbounds-asgraphicsannotxlabelxx-xy-">Issue 5: Error in grid.Call(C_textBounds, as.graphicsAnnot(xlabel),x<span class="math inline"><em>x</em>, <em>x</em></span>y, :<a class="anchor" aria-label="anchor" href="#issue-5-error-in-gridcallc_textbounds-asgraphicsannotxlabelxx-xy-"></a>
</h3>
<p>When encountering the following error:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">grid.Call</span>(C_textBounds, <span class="fu">as.graphicsAnnot</span>(xlabel),x<span class="sc">$</span>x, x<span class="sc">$</span>y, <span class="sc">:</span></span></code></pre></div>
<p>Please having some required fonts installed. You can refer to this <a href="https://stackoverflow.com/questions/71362738/r-error-in-grid-callc-textbounds-as-graphicsannotxlabel-xx-xy-polygo" class="external-link">thread</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="authors-other-projects">Author’s other projects<a class="anchor" aria-label="anchor" href="#authors-other-projects"></a>
</h2>
<p><a href="https://a95dps-caffery-chen.shinyapps.io/MicrobiomeGallery/" class="external-link">MicrobiomeGallery</a>, a web-based platform for sharing microbiome data visualization code and datasets. （It’s still under construction）</p>
<p><img src="https://raw.githubusercontent.com/cafferychen777/ggpicrust2_paper/main/paper_figure/MicrobiomeGallery_preview.jpg"></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ggpicrust2" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/cafferychen777/ggpicrust2/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/cafferychen777/ggpicrust2/pulls" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggpicrust2</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Chen Yang <br><small class="roles"> Author, maintainer </small>  </li>
<li>Liangliang Zhang <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Chen Yang, Liangliang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
